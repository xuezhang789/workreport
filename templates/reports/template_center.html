{% extends "base_topbar.html" %}
{% block title %}æ¨¡æ¿ä¸­å¿ƒ / Template Center{% endblock %}
{% block nav_header %}{% include "partials/nav.html" with nav_title="æ¨¡æ¿ä¸­å¿ƒ / Template Center" nav_subtitle="æŒ‰è§’è‰²ä¸é¡¹ç›®å…±äº«æ—¥æŠ¥ä¸ä»»åŠ¡æ¨¡æ¿ / Share report & task templates by role/project" %}{% endblock %}
{% block extra_styles %}
        :root {
            --primary: #2563eb;
            --primary-2: #3b82f6;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #8b5cf6;
            --bg-card: rgba(255, 255, 255, 0.95);
            --bg-section: rgba(248, 250, 252, 0.9);
            --bg-glass: rgba(255, 255, 255, 0.8);
            --border-light: rgba(226, 232, 240, 0.7);
            --border-strong: rgba(59, 130, 246, 0.2);
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --radius-lg: 20px;
            --radius-md: 14px;
            --radius-sm: 10px;
            --shadow-sm: 0 4px 20px rgba(15, 23, 42, 0.08);
            --shadow-md: 0 8px 28px rgba(15, 23, 42, 0.1);
            --shadow-lg: 0 12px 40px rgba(15, 23, 42, 0.15);
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%);
            background-attachment: fixed;
            min-height: 100vh;
            font-family: 'Space Grotesk', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .template-page {
            position: relative;
            z-index: 1;
        }

        .page-shell {
            max-width: 1240px;
            margin: 0 auto;
            display: grid;
            gap: 20px;
            padding: 4px 0 24px;
        }

        .banner {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-glass));
            backdrop-filter: blur(18px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: clamp(24px, 4vw, 36px);
            display: grid;
            grid-template-columns: minmax(0, 1.6fr) minmax(0, 1fr);
            gap: 20px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--primary-2), var(--accent));
            opacity: 0.8;
        }

        .banner::after {
            content: '';
            position: absolute;
            right: -20%;
            bottom: -40%;
            width: 360px;
            height: 360px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.08) 0%, transparent 65%);
        }

        .eyebrow {
            font-size: 13px;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin: 0 0 6px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .banner h1 {
            margin: 0 0 8px;
            font-size: clamp(24px, 3vw, 30px);
            font-weight: 800;
            color: var(--text-primary);
        }

        .subtitle {
            margin: 0 0 14px;
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.6;
        }

        .chip-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 6px;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            border-radius: 14px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(255, 255, 255, 0.9));
            border: 1px solid var(--border-light);
            font-size: 13px;
            color: var(--text-secondary);
            box-shadow: var(--shadow-sm);
        }

        .chip strong { color: var(--text-primary); }

        .callout {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.06), rgba(6, 182, 212, 0.05));
            border: 1px dashed var(--border-strong);
            border-radius: var(--radius-md);
            padding: 16px;
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.55;
            box-shadow: var(--shadow-sm);
        }

        .callout h4 {
            margin: 0 0 6px;
            font-size: 14px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 700;
        }

        .callout ul {
            margin: 0;
            padding-left: 18px;
        }

        .card-block {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-section));
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: 22px clamp(18px, 3vw, 26px);
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .card-block::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 10% 20%, rgba(59, 130, 246, 0.05), transparent 35%);
            pointer-events: none;
        }

        .card-block:hover { box-shadow: var(--shadow-lg); }

        .section-head {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
            margin-bottom: 12px;
        }

        .section-title {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .muted {
            margin: 4px 0 0;
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border-radius: 999px;
            background: rgba(37, 99, 235, 0.08);
            color: var(--text-primary);
            font-size: 12px;
            border: 1px solid var(--border-strong);
            box-shadow: var(--shadow-sm);
        }

        .filters-card .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 14px;
            margin-top: 12px;
        }

        .field {
            display: grid;
            gap: 8px;
        }

        .field label {
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .field label::before {
            content: '';
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--primary);
        }

        input, select {
            width: 100%;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-light);
            padding: 13px 14px;
            font-size: 14px;
            background: var(--bg-glass);
            color: var(--text-primary);
            outline: none;
            transition: var(--transition);
            box-shadow: 0 2px 10px rgba(15, 23, 42, 0.05);
            font-family: inherit;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
            background: #fff;
        }

        .form-actions {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 2px;
        }

        .btn {
            border: none;
            border-radius: var(--radius-md);
            padding: 12px 18px;
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            background: linear-gradient(135deg, var(--primary), var(--primary-2));
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.25);
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(59, 130, 246, 0.35); }
        .btn:active { transform: translateY(0); }

        .btn-ghost {
            background: linear-gradient(135deg, #ffffff, var(--bg-section));
            color: var(--text-primary);
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 14px;
            margin-top: 8px;
            position: relative;
            z-index: 1;
        }

        .form-card {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-glass));
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 16px;
            box-shadow: var(--shadow-sm);
        }

        .form-card h3 {
            margin: 0 0 10px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-card p {
            margin: 0 0 10px;
            display: grid;
            gap: 6px;
            font-size: 14px;
        }

        .form-card label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 13px;
        }

        .form-card input, .form-card select, .form-card textarea {
            width: 100%;
        }

        .template-card {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-glass));
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 14px;
            box-shadow: var(--shadow-sm);
            display: grid;
            gap: 6px;
            position: relative;
            overflow: hidden;
        }

        .template-card.new {
            border-color: rgba(59, 130, 246, 0.35);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.18);
        }

        .template-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 80% 0%, rgba(59, 130, 246, 0.05), transparent 30%);
            pointer-events: none;
        }

        .template-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }

        .template-header {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .template-meta {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .template-content {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .subhead {
            margin: 18px 0 8px;
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            display: inline-flex;
            gap: 8px;
            align-items: center;
        }

        .empty-state {
            margin: 6px 0;
            padding: 16px;
            border-radius: var(--radius-md);
            border: 1px dashed var(--border-light);
            color: var(--text-muted);
            text-align: center;
            background: linear-gradient(135deg, rgba(148, 163, 184, 0.06), rgba(255, 255, 255, 0.95));
        }

        .pagination {
            margin-top: 12px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            align-items: center;
            flex-wrap: wrap;
            font-size: 13px;
        }

        .page-stat {
            padding: 8px 10px;
            border-radius: var(--radius-sm);
            background: rgba(37, 99, 235, 0.08);
            border: 1px solid var(--border-strong);
            color: var(--text-primary);
            font-size: 12px;
        }

        .jump-form {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .jump-form input[type="number"] {
            width: 80px;
            padding: 8px 10px;
            font-size: 13px;
        }

        .jump-label {
            margin: 0;
            color: var(--text-secondary);
            font-size: 12px;
        }

        .note {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 6px;
            line-height: 1.5;
        }

        @media (max-width: 960px) {
            .banner {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 640px) {
            .page-shell { gap: 16px; }
            .card-block, .banner { border-radius: 16px; padding: 18px; }
            .template-grid { grid-template-columns: 1fr; }
            .filters-card .form-grid { grid-template-columns: 1fr; }
            .form-actions { justify-content: flex-start; }
            .btn { width: 100%; justify-content: center; }
            .jump-form { width: 100%; justify-content: center; }
        }
{% endblock %}
{% block content %}
<div class="template-page">
    <div class="page-shell">
        <section class="banner">
            <div>
                <p class="eyebrow">ğŸ“‹ æ¨¡æ¿ç®¡ç† / Template Management</p>
                <h1>æ¨¡æ¿ä¸­å¿ƒ / Template Center</h1>
                <p class="subtitle">æŒ‰è§’è‰²ä¸é¡¹ç›®å…±äº«æ—¥æŠ¥ä¸ä»»åŠ¡æ¨¡æ¿ï¼Œä¿æŒä¸å·¥ä½œå°ä¸€è‡´çš„è§†è§‰ä¸äº¤äº’ä½“éªŒ / Share report & task templates by role/project with the same visual language as the workbench.</p>
                <div class="chip-row">
                    <span class="chip"><strong>ç±»å‹ / Types:</strong> æ—¥æŠ¥ Â· ä»»åŠ¡</span>
                    <span class="chip"><strong>èŒƒå›´ / Scope:</strong> é¡¹ç›® Â· è§’è‰² Â· å…¨å±€</span>
                    <span class="chip"><strong>ç‰ˆæœ¬ / Version:</strong> è‡ªåŠ¨è®°å½• / Auto versioned</span>
                </div>
            </div>
            <div class="callout">
                <h4>ä¼˜å…ˆçº§ / Priority</h4>
                <ul>
                    <li>æŒ‰ é¡¹ç›® â†’ è§’è‰² â†’ å…¨å±€ åŒ¹é…æœ€æ–°ç‰ˆæœ¬ / Match by Project â†’ Role â†’ Global (latest version).</li>
                    <li>æœªå‘½ä¸­æ—¶ä¼šæç¤ºå¹¶å›é€€é»˜è®¤æ¨¡æ¿ / When missing, fallback to default and show notice.</li>
                    <li>ä¿æŒåŒè¯­æ–‡æ¡ˆä¸å·¥ä½œå°ä¸€è‡´ / Bilingual copy aligned with workbench tone.</li>
                </ul>
            </div>
        </section>

        <section class="card-block filters-card">
            <div class="section-head">
                <div>
                    <p class="eyebrow">ç­›é€‰ / Filter</p>
                    <h2 class="section-title">å¿«é€Ÿå®šä½æ¨¡æ¿ / Quickly find templates</h2>
                    <p class="muted">å¯æŒ‰å…³é”®è¯ã€è§’è‰²ã€é¡¹ç›®ä¸æ’åºç»„åˆæ£€ç´¢ / Search by keyword, role, project, and sort.</p>
                </div>
                <div class="pill">å½“å‰æ’åº / Current: {% if sort == 'updated' %}æŒ‰æ›´æ–°æ—¶é—´ / By updated{% else %}æŒ‰ç‰ˆæœ¬ / By version{% endif %}</div>
            </div>
            <form method="get" class="form-grid">
                <div class="field">
                    <label>å…³é”®è¯ / Keyword</label>
                    <input type="text" name="q" value="{{ q }}" placeholder="æŒ‰åç§°/å†…å®¹æœç´¢ / Search by name or content">
                </div>
                <div class="field">
                    <label>è§’è‰² / Role</label>
                    <select name="role">
                        <option value="">å…¨éƒ¨ / All</option>
                        {% for val,label in report_form.fields.role.choices %}
                            <option value="{{ val }}" {% if role_filter == val %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="field">
                    <label>é¡¹ç›® / Project</label>
                    <select name="project">
                        <option value="">å…¨éƒ¨ / All</option>
                        {% for p in projects %}
                            <option value="{{ p.id }}" {% if project_filter == p.id %}selected{% endif %}>{{ p.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="field">
                    <label>æ’åº / Sort</label>
                    <div style="display:flex;gap:8px;flex-wrap:wrap;">
                        <button type="submit" name="sort" value="version" class="btn {% if sort == 'version' %}{% else %}btn-ghost{% endif %}">ç‰ˆæœ¬ä¼˜å…ˆ / Version first</button>
                        <button type="submit" name="sort" value="updated" class="btn {% if sort == 'updated' %}{% else %}btn-ghost{% endif %}">æ›´æ–°æ—¶é—´ä¼˜å…ˆ / Updated first</button>
                        <button type="submit" name="sort" value="usage" class="btn {% if sort == 'usage' %}{% else %}btn-ghost{% endif %}">ä½¿ç”¨æ¬¡æ•° / By usage</button>
                    </div>
                    <p class="note">æç¤ºï¼šç‰ˆæœ¬ä¼˜å…ˆå¸¸ç”¨äºå†å²å›æº¯ï¼›æ›´æ–°æ—¶é—´ä¼˜å…ˆä¾¿äºæŸ¥çœ‹æœ€æ–°ç¼–è¾‘ï¼›æŒ‰ä½¿ç”¨æ¬¡æ•°èƒ½å¿«é€Ÿæ‰¾åˆ°å¸¸ç”¨æ¨¡æ¿ / Version=history, Updated=latest, Usage=popular.</p>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">ğŸ” ç­›é€‰ / Filter</button>
                    <a href="{% url 'reports:template_center' %}" class="btn btn-ghost">é‡ç½® / Reset</a>
                </div>
            </form>
        </section>

        <section class="card-block">
            <div class="section-head">
                <div>
                    <p class="eyebrow">åˆ›å»º / Create</p>
                    <h2 class="section-title">æ¨¡æ¿åˆ›å»º / Create Templates</h2>
                    <p class="muted">æ”¯æŒé¡¹ç›®/è§’è‰²å…±äº«å¹¶è‡ªåŠ¨è®°å½•ç‰ˆæœ¬ï¼Œä¿æŒåŒè¯­å¡«å†™æŒ‡å¼• / Share by project & role with auto versioning and bilingual hints.</p>
                </div>
            </div>
            <div class="callout" style="margin-bottom:16px;">
                <h4>ğŸ“„ æ—¥æŠ¥æ¨¡æ¿é»˜è®¤æ ¼å¼ / Default Report Template</h4>
                <ul>
                    <li><strong>æ—¥æœŸ / Dateï¼š</strong>YYYY-MM-DDï¼Œç¤ºä¾‹ Exampleï¼š2025-01-01</li>
                    <li><strong>ä»Šæ—¥å·¥ä½œ / Todayâ€™s Workï¼š</strong>å®Œæˆé¡¹ + ç»“æœï¼ˆä¾‹ï¼šå®Œæˆæ¥å£å¼€å‘ / Finished API endpointsï¼‰</li>
                    <li><strong>è¿›åº¦ä¸é—®é¢˜ / Progress & Issuesï¼š</strong>é£é™©ã€é˜»å¡ã€ä¾èµ–ï¼ˆä¾‹ï¼šä¸Šçº¿çª—å£å¾…ç¡®è®¤ / Release window pendingï¼‰</li>
                    <li><strong>æ˜æ—¥è®¡åˆ’ / Plan for Tomorrowï¼š</strong>ä¸‹ä¸€æ­¥åŠ¨ä½œä¸é¢„æœŸç»“æœï¼ˆä¾‹ï¼šè”è°ƒå¹¶å®Œæˆå›å½’ / Integration + regressionï¼‰</li>
                    <li><strong>ï¼ˆå¯é€‰ï¼‰æµ‹è¯•/äº§å“/è®¾è®¡/è¿ç»´å­—æ®µï¼š</strong>æŒ‰è§’è‰²å¡«å†™æµ‹è¯•èŒƒå›´ã€åé¦ˆã€ç›‘æ§ç­‰ / Role-specific fields (QA/Product/UI/Ops)</li>
                </ul>
                <p class="muted">ç¤ºä¾‹æ•°æ® / Sample: Today: å®Œæˆæ¥å£å¼€å‘ï¼›Issues: éœ€æ¥å£æ–‡æ¡£è¯„å®¡ï¼›Tomorrow: è”è°ƒ & å›å½’ï¼›Testing: å›å½’ 12 ä¸ªç”¨ä¾‹ã€‚</p>
                <h4 style="margin-top:10px;">âœ… ä»»åŠ¡æ¨¡æ¿é»˜è®¤ç»“æ„ / Default Task Template</h4>
                <ul>
                    <li><strong>åç§° / Nameï¼š</strong>å¦‚â€œä¸Šçº¿ä»»åŠ¡æ¨¡æ¿ / Release Taskâ€</li>
                    <li><strong>æ ‡é¢˜ / Titleï¼š</strong>å¦‚â€œå‘å¸ƒ v1.2 ç‰ˆæœ¬ / Release v1.2â€</li>
                    <li><strong>å†…å®¹ / Contentï¼š</strong>æ­¥éª¤åˆ—è¡¨ + è´Ÿè´£äººï¼ˆä¾‹ï¼š1) æ£€æŸ¥éƒ¨ç½²åŒ… / Check build 2) é¢„å‘éªŒè¯ / Staging verify 3) æ­£å¼å‘å¸ƒ / Prod rolloutï¼‰</li>
                    <li><strong>é“¾æ¥ / URLï¼š</strong>å¯é€‰ï¼Œå…³è”éœ€æ±‚/å·¥å• / Optional related link</li>
                </ul>
                <p class="muted">ç¤ºä¾‹æ•°æ® / Sample: Title=å‘å¸ƒ v1.2ï¼›Content=æ£€æŸ¥æ„å»ºâ†’é¢„å‘éªŒè¯â†’ç°åº¦â†’å…¨é‡â†’éªŒè¯ç›‘æ§ï¼›URL=https://example.com/tickets/123.</p>
                <p class="muted">ç°è‰²å ä½ç¬¦å·²ä¸ºå…³é”®å­—æ®µç»™å‡ºä¸­è‹±æ–‡æç¤ºï¼Œç›´æ¥å‚è€ƒå¹¶è¦†ç›–å³å¯ / Grey placeholders show CN/EN guidanceâ€”use or replace as needed.</p>
            </div>
            <div class="template-grid">
                <form method="post" action="" class="form-card">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="report">
                    <h3>ğŸ“„ æ—¥æŠ¥æ¨¡æ¿ / Report Template</h3>
                    {{ report_form.as_p }}
                    <button type="submit" class="btn">ä¿å­˜æ—¥æŠ¥æ¨¡æ¿ / Save Report Template</button>
                </form>
                <form method="post" action="" class="form-card">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="task">
                    <h3>âœ… ä»»åŠ¡æ¨¡æ¿ / Task Template</h3>
                    {{ task_form.as_p }}
                    <button type="submit" class="btn">ä¿å­˜ä»»åŠ¡æ¨¡æ¿ / Save Task Template</button>
                </form>
            </div>
        </section>

        <section class="card-block">
            <div class="section-head">
                <div>
                    <p class="eyebrow">æœ€æ–° / Latest</p>
                    <h2 class="section-title">æœ€æ–°æ¨¡æ¿ / Latest Templates</h2>
                    <p class="muted">ä¼˜å…ˆæ˜¾ç¤ºç¬¦åˆç­›é€‰çš„æœ€æ–°ç‰ˆæœ¬ï¼›æœªåŒ¹é…æ—¶å¯æ¸…ç©ºç­›é€‰æˆ–åˆ‡æ¢é¡¹ç›®/è§’è‰² / Shows latest for current filters; clear or switch filters if none.</p>
                </div>
                <span class="pill">æ’åº / Sort: {% if sort == 'updated' %}æ›´æ–°æ—¶é—´ / Updated{% else %}ç‰ˆæœ¬å· / Version{% endif %}</span>
            </div>

            <h3 class="subhead">ğŸ“„ æ—¥æŠ¥æ¨¡æ¿ / Report Templates</h3>
            <div class="template-grid">
                {% for tmpl in report_templates %}
                <article class="template-card {% if report_templates.number == 1 and forloop.first %}new{% endif %}">
                    <div class="template-header">ğŸ“„ {{ tmpl.name }}</div>
                    <div class="template-meta">
                        è§’è‰² / Role: {{ tmpl.get_role_display|default:"å…¨éƒ¨ / All" }} Â· é¡¹ç›® / Project: {{ tmpl.project.name|default:"å…¨å±€ / Global" }}
                    </div>
                    <div class="template-meta">ç‰ˆæœ¬ / Version: v{{ tmpl.version }}</div>
                    <div class="template-meta">ä½¿ç”¨æ¬¡æ•° / Usage: {{ tmpl.usage_count|default:0 }}</div>
                    <div class="template-content">{{ tmpl.content|truncatechars:120 }}</div>
                </article>
                {% empty %}
                <div class="empty-state">æš‚æ— æ—¥æŠ¥æ¨¡æ¿ / No Report Templates Available</div>
                {% endfor %}
            </div>
            {% if report_templates.has_other_pages %}
            <div class="pagination">
                {% if report_templates.has_previous %}<a class="btn btn-ghost" href="?rpage={{ report_templates.previous_page_number }}&q={{ q }}&role={{ role_filter }}&project={{ project_filter }}&sort={{ sort }}">ä¸Šä¸€é¡µ / Prev</a>{% endif %}
                <span class="page-stat">ç¬¬ {{ report_templates.number }} / {{ report_templates.paginator.num_pages }} é¡µ / Page</span>
                {% if report_templates.has_next %}<a class="btn btn-ghost" href="?rpage={{ report_templates.next_page_number }}&q={{ q }}&role={{ role_filter }}&project={{ project_filter }}&sort={{ sort }}">ä¸‹ä¸€é¡µ / Next</a>{% endif %}
                <form method="get" class="jump-form">
                    <input type="hidden" name="q" value="{{ q }}">
                    <input type="hidden" name="role" value="{{ role_filter }}">
                    <input type="hidden" name="project" value="{{ project_filter }}">
                    <input type="hidden" name="sort" value="{{ sort }}">
                    <label class="jump-label" for="rpage-input">è·³è½¬ / Jump</label>
                    <input id="rpage-input" type="number" name="rpage" min="1" max="{{ report_templates.paginator.num_pages }}">
                    <button class="btn btn-ghost" type="submit">Go</button>
                </form>
            </div>
            {% endif %}

            <h3 class="subhead">âœ… ä»»åŠ¡æ¨¡æ¿ / Task Templates</h3>
            <div class="template-grid">
                {% for tmpl in task_templates %}
                <article class="template-card {% if task_templates.number == 1 and forloop.first %}new{% endif %}">
                    <div class="template-header">âœ… {{ tmpl.name }}</div>
                    <div class="template-meta">
                        è§’è‰² / Role: {{ tmpl.get_role_display|default:"å…¨éƒ¨ / All" }} Â· é¡¹ç›® / Project: {{ tmpl.project.name|default:"å…¨å±€ / Global" }}
                    </div>
                    <div class="template-meta">ç‰ˆæœ¬ / Version: v{{ tmpl.version }}</div>
                    <div class="template-meta">ä½¿ç”¨æ¬¡æ•° / Usage: {{ tmpl.usage_count|default:0 }}</div>
                    <div class="template-content">{{ tmpl.title }} â€” {{ tmpl.content|truncatechars:120 }}</div>
                </article>
                {% empty %}
                <div class="empty-state">æš‚æ— ä»»åŠ¡æ¨¡æ¿ / No Task Templates Available</div>
                {% endfor %}
            </div>
            {% if task_templates.has_other_pages %}
            <div class="pagination">
                {% if task_templates.has_previous %}<a class="btn btn-ghost" href="?tpage={{ task_templates.previous_page_number }}&q={{ q }}&role={{ role_filter }}&project={{ project_filter }}&sort={{ sort }}">ä¸Šä¸€é¡µ / Prev</a>{% endif %}
                <span class="page-stat">ç¬¬ {{ task_templates.number }} / {{ task_templates.paginator.num_pages }} é¡µ / Page</span>
                {% if task_templates.has_next %}<a class="btn btn-ghost" href="?tpage={{ task_templates.next_page_number }}&q={{ q }}&role={{ role_filter }}&project={{ project_filter }}&sort={{ sort }}">ä¸‹ä¸€é¡µ / Next</a>{% endif %}
                <form method="get" class="jump-form">
                    <input type="hidden" name="q" value="{{ q }}">
                    <input type="hidden" name="role" value="{{ role_filter }}">
                    <input type="hidden" name="project" value="{{ project_filter }}">
                    <input type="hidden" name="sort" value="{{ sort }}">
                    <label class="jump-label" for="tpage-input">è·³è½¬ / Jump</label>
                    <input id="tpage-input" type="number" name="tpage" min="1" max="{{ task_templates.paginator.num_pages }}" required>
                    <button class="btn btn-ghost" type="submit">Go</button>
                </form>
            </div>
            {% endif %}
        </section>
    </div>
</div>
{% endblock %}
